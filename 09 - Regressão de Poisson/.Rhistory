knitr::opts_chunk$set(echo = TRUE)
dados <- read.csv('Birth.csv')
plot(children ~ age, data = dados, col = 'blue', pch = 1, ylim = c(0,9))
modelo <- glm(children ~ age, family = poisson, data = dados)
summary(modelo)
dados$Deviance <- residuals(modelo, type='deviance')
dados$Pearson <- residuals(modelo, type='pearson')
dt <- data.frame(age = seq(16, 45, length=100))
dt$fit <- predict(modelo, newdata = dt, type='response')
plot(children ~ age, data = dados, col = 'blue', pch = 1, ylim = c(0,9))
lines(fit ~ age, lwd = 1, col = 'black', data = dt)
dt$Inferior <- qpois(p = 0.025, lambda = dt$fit)
dt$Superior <- qpois(p = 0.975, lambda = dt$fit)
lines(Inferior ~ age, lwd = 1, col = 'green', data = dt)
lines(Superior ~ age, lwd = 1, col = 'red', data = dt)
knitr::opts_chunk$set(echo = TRUE)
dados <- read.csv("motorins.dat", sep="")
dados$Kilometres <- factor(dados$Kilometres)
levels(dados$Kilometres) <-  c("< 1000", "1000 ~ 15000", "15000 ~ 20000", "20000 ~ 25000", "> 25000")
dados$Zone <- factor(dados$Zone)
levels(dados$Zone) <- c("Stockholm...", "Large cities", "Pequenas cidades do sul", "Area rural do sul", "Pequenas cidades do norte",
"Area rural do norte", "Gotland")
dados$Make <- factor(dados$Make)
levels(dados$Make) <- c("Tipo 1", "Tipo 2", "Tipo 3", "Tipo 4", "Tipo 5", "Tipo 6", "Tipo 7", "Tipo 8", "Tipo 9")
modelo <- glm(Claims ~ offset(log(Insured)) + Kilometres + Zone +  Make +  Bonus, data = dados, family = poisson)
summary(modelo)
require(MASS)
modelo <- glm.nb(Claims ~ offset(log(Insured)) + Kilometres + Zone +  Make +  Bonus, data = dados)
summary(modelo)
knitr::opts_chunk$set(echo = TRUE)
dados <- read.csv('danishlc.dat', sep="")
dados <- read.csv('danishlc.dat', sep="")
dados <- read.csv('danishlc.dat', sep="")
View(dados)
dados <- read.csv("danishlc.dat", sep="\t")
dados$Age <- factor(dados$Age,
levels = c("40-54", "55-59", "60-64", "65-69", "70-74", ">74"))
dados$City <- as.factor(dados$City)
dados$Prop <- dados$Cases/dados$Pop
dados$Diff <- dados$Pop-dados$Cases
View(dados)
dados <- read.csv("danishlc.dat", sep="\t")
dados$Age <- factor(dados$Age,
levels = c("40-54", "55-59", "60-64", "65-69", "70-74", ">74"))
dados$City <- as.factor(dados$City)
knitr::opts_chunk$set(echo = TRUE)
dados <- read.csv("danishlc.dat", sep="\t")
dados$Age <- factor(dados$Age,
levels = c("40-54", "55-59", "60-64", "65-69", "70-74", ">74"))
dados$City <- as.factor(dados$City)
dados$Prop <- dados$Cases/dados$Pop
dados$Diff <- dados$Pop-dados$Cases
plot(Prop ~ Age, data=dados)
plot(Prop ~ City, data=dados)
modelo <- glm(cbind(Cases, Diff) ~ Age + City, data = dados, family = binomial)
summary(modelo)
modelo2 <- glm(cbind(Cases, Diff) ~ Age:City, data = dados, family = binomial)
summary(modelo2)
dados <- read.csv("danishlc.dat", sep="\t")
dados$Age <- factor(dados$Age,
levels = c("40-54", "55-59", "60-64", "65-69", "70-74", ">74"))
dados$City <- as.factor(dados$City)
View(dados)
dados <- read.csv("danishlc.dat", sep="\t")
dados$Age <- factor(dados$Age,
levels = c("40-54", "55-59", "60-64", "65-69", "70-74", ">74"))
dados$City <- as.factor(dados$City)
modelo <- glm(Cases ~ offset(log(Pop)) + Age + City, data = dados, family = poisson)
summary(modelo)
dados2 <- read.csv("danishlc.dat", sep="\t")
dados2$Age <- factor(dados$Age,
levels = c("40-54", "55-59", "60-64", "65-69", "70-74", ">74"))
dados2 <- read.csv("danishlc.dat", sep="\t")
dados2$Age <- factor(dados2$Age,
levels = c("40-54", "55-59", "60-64", "65-69", "70-74", ">74"))
dados2$City <- as.factor(dados2$City)
modelo2 <- glm(Cases ~ offset(log(Pop)) + Age + City, data = dados, family = poisson)
dados2 <- read.csv("danishlc.dat", sep="\t")
dados2$Age <- factor(dados2$Age,
levels = c("40-54", "55-59", "60-64", "65-69", "70-74", ">74"))
dados2$City <- as.factor(dados2$City)
modelo2 <- glm(Cases ~ offset(log(Pop)) + Age + City, data = dados2, family = poisson)
summary(modelo2)
dados3 <- read.csv("danishlc.dat", sep="\t")
dados3$Age <- factor(dados3$Age,
levels = c("40-54", "55-59", "60-64", "65-69", "70-74", ">74"))
dados3$City <- as.factor(dados3$City)
modelo3 <- glm(Cases ~ offset(log(Pop)) + Age + City, data = dados3, family = poisson)
summary(modelo2)
dados1 <- read.csv("motorins.dat", sep="")
dados1$Kilometres <- factor(dados1$Kilometres)
levels(dados1$Kilometres) <-  c("< 1000", "1000 ~ 15000", "15000 ~ 20000", "20000 ~ 25000", "> 25000")
dados1$Zone <- factor(dados1$Zone)
levels(dados1$Zone) <- c("Stockholm...", "Large cities", "Pequenas cidades do sul", "Area rural do sul", "Pequenas cidades do norte",
"Area rural do norte", "Gotland")
dados1$Make <- factor(dados1$Make)
levels(dados1$Make) <- c("Tipo 1", "Tipo 2", "Tipo 3", "Tipo 4", "Tipo 5", "Tipo 6", "Tipo 7", "Tipo 8", "Tipo 9")
#Leitura e modificação dos dados
dados1 <- read.csv("motorins.dat", sep="")
dados1$Kilometres <- factor(dados1$Kilometres)
levels(dados1$Kilometres) <-  c("< 1000", "1000 ~ 15000", "15000 ~ 20000", "20000 ~ 25000", "> 25000")
dados1$Zone <- factor(dados1$Zone)
levels(dados1$Zone) <- c("Stockholm...", "Large cities", "Pequenas cidades do sul", "Area rural do sul", "Pequenas cidades do norte",
"Area rural do norte", "Gotland")
dados1$Make <- factor(dados1$Make)
levels(dados1$Make) <- c("Tipo 1", "Tipo 2", "Tipo 3", "Tipo 4", "Tipo 5", "Tipo 6", "Tipo 7", "Tipo 8", "Tipo 9")
#Regressão sem Offset
modelo1 <- glm(Claims ~ Insured + Kilometres + Zone +  Make +  Bonus, data = dados1, family = poisson)
summary(modelo)
#Leitura e modificação dos dados
dados1 <- read.csv("motorins.dat", sep="")
dados1$Kilometres <- factor(dados1$Kilometres)
levels(dados1$Kilometres) <-  c("< 1000", "1000 ~ 15000", "15000 ~ 20000", "20000 ~ 25000", "> 25000")
dados1$Zone <- factor(dados1$Zone)
levels(dados1$Zone) <- c("Stockholm...", "Large cities", "Pequenas cidades do sul", "Area rural do sul", "Pequenas cidades do norte",
"Area rural do norte", "Gotland")
dados1$Make <- factor(dados1$Make)
levels(dados1$Make) <- c("Tipo 1", "Tipo 2", "Tipo 3", "Tipo 4", "Tipo 5", "Tipo 6", "Tipo 7", "Tipo 8", "Tipo 9")
#Regressão sem Offset
modelo1 <- glm(Claims ~ Insured + Kilometres + Zone +  Make +  Bonus, data = dados1, family = poisson)
summary(modelo1)
#Regressão com Offset
modelo2 <- glm(Claims ~ offset(log(Insured)) + Kilometres + Zone +  Make +  Bonus, data = dados1, family = poisson)
summary(modelo2)
