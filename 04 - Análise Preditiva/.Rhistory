knitr::opts_chunk$set(echo = TRUE)
require(googleVis)
dados <- read.delim("boston_corrected.txt", skip = 11)
dados <- na.omit(dados)
dados$id    <- 1:nrow(dados)
dados$tempo <- rep(2020, nrow(dados))
saida <- gvisMotionChart(dados, idvar="id", timevar="tempo")
plot(saida)
# Seleciona somente algumas variaveis...
dados <- dados[,c(7,9:21)]
require(packHV)
require(exploreR)
require(corrplot)
hist_boxplot(dados$MEDV, main="", xlab="MEDV", col="light blue")
rug(dados$MEDV)
cor(dados$MEDV, log(dados$LSTAT))
corMat <- cor(dados, method="spearman")
corrplot(corMat, method = "ellipse", type="upper", order="AOE",
diag=FALSE, addgrid.col=NA, outline=TRUE)
plot(MEDV ~ CRIM, data=dados, pch=19, col="blue")
plot(MEDV ~ ZN, data=dados, pch=19, col="blue")
plot(MEDV ~ INDUS, data=dados, pch=19, col="blue")
plot(MEDV ~ CHAS, data=dados, pch=19, col="blue")
plot(MEDV ~ NOX, data=dados, pch=19, col="blue")
plot(MEDV ~ RM, data=dados, pch=19, col="blue")
plot(MEDV ~ AGE, data=dados, pch=19, col="blue")
plot(MEDV ~ DIS, data=dados, pch=19, col="blue")
plot(MEDV ~ RAD, data=dados, pch=19, col="blue")
plot(MEDV ~ TAX, data=dados, pch=19, col="blue")
plot(MEDV ~ PTRATIO, data=dados, pch=19, col="blue")
plot(MEDV ~ B, data=dados, pch=19, col="blue")
plot(MEDV ~ LSTAT, data=dados, pch=19, col="blue")
dados$logCRIM    <- log(dados$CRIM)
dados$logZN      <- log(dados$ZN + 1)
dados$logINDUS   <- log(dados$INDUS)
dados$logCHAS    <- log(dados$CHAS + 1)
dados$logNOX     <- log(dados$NOX)
dados$logRM      <- log(dados$RM)
dados$logAGE     <- log(dados$AGE)
dados$logDIS     <- log(dados$DIS)
dados$logRAD     <- log(dados$RAD)
dados$logTAX     <- log(dados$TAX)
dados$logPTRATIO <- log(dados$PTRATIO)
dados$logB       <- log(dados$B)
dados$logLSTAT   <- log(dados$LSTAT)
saida <- masslm(dados, "MEDV")
saida <- saida[order(saida$R.squared, decreasing=TRUE),]
require(car)
modelo <- lm(MEDV ~ CRIM + ZN + INDUS + CHAS + NOX + RM +
AGE + DIS + RAD + TAX + PTRATIO + B + LSTAT, data=dados)
summary(modelo)
vif(modelo)
plot(modelo)
modelo <- lm(MEDV ~ ., data=dados)
summary(modelo)
plot(modelo)
hist_boxplot(residuals(modelo))
shapiro.test(residuals(modelo))
# Selecao
modelo <- step(modelo)
summary(modelo)
plot(modelo)
y    <- dados$MEDV
yhat <- rep(NA, nrow(dados))
for(cont in 1:nrow(dados)){
modelo <- lm(MEDV ~ CRIM + INDUS + CHAS + NOX + RM + PTRATIO + B + logCRIM + logINDUS + logRM + logDIS + logRAD + logTAX + logPTRATIO + logLSTAT, data=dados[-cont,])
yhat[cont] <- predict(modelo, newdata=dados[cont,])
}
plot(yhat ~ y, pch=19, col="blue")
abline(a=0, b=1, lwd=2, col="red")
R2pred <- 1 - sum( (y-yhat)^2 )/sum( (y-mean(y))^2 )
## Analise dos residuos
modelo <- lm(MEDV ~ CRIM + INDUS + CHAS + NOX + RM + PTRATIO + B + logCRIM + logINDUS + logRM + logDIS + logRAD + logTAX + logPTRATIO + logLSTAT, data=dados)
summary(modelo)
plot(modelo)
shapiro.test(residuals(modelo))
hist_boxplot(residuals(modelo))
require(rpart)
require(rpart.plot)
x <- seq(-1, +1, length=100)
y <- 0.5 + 1.5 * x + rnorm(length(x), sd=0.5)
plot(y ~ x)
ndados <- data.frame(x=x, y=y)
modelo <- rpart(y~x, data=dados)
# control = rpart.control(maxdepth=2)
rpart.plot(modelo) #
plot(y~x, pch=19, col="blue")
lines(predict(modelo) ~ ndados$x, col="red", lwd=2)
modelo <- rpart(MEDV ~ CRIM + ZN + INDUS + CHAS + NOX + RM +
AGE + DIS + RAD + TAX + PTRATIO + B + LSTAT, data=dados)
rpart.plot(modelo)
residuos <- residuals(modelo)
shapiro.test(residuos)
## Validacao cruzada
y    <- dados$MEDV
yhat <- rep(NA, nrow(dados))
for(cont in 1:nrow(dados)){
modelo <- rpart(MEDV ~ CRIM + ZN + INDUS + CHAS + NOX + RM +
AGE + DIS + RAD + TAX + PTRATIO + B + LSTAT, data=dados[-cont,],
control = rpart.control(maxdepth=5))
yhat[cont] <- predict(modelo, newdata=dados[cont,])
}
plot(yhat ~ y, pch=19, col="blue")
abline(a=0, b=1, lwd=2, col="red")
(R2pred <- 1 - sum( (y-yhat)^2 )/sum( (y-mean(y))^2 ))
require(googleVis)
dados <- read.delim("boston_corrected.txt", skip = 11)
dados <- na.omit(dados)
dados$id    <- 1:nrow(dados)
dados$tempo <- rep(2020, nrow(dados))
saida <- gvisMotionChart(dados, idvar="id", timevar="tempo")
plot(saida)
# Seleciona somente algumas variaveis...
dados <- dados[,c(7,9:21)]
